<div class="layout-container">
  <form [formGroup]="form" class="form-container">
    <!-- Pa√≠s -->
    <div class="form-group">
      <label for="pais">üåç Pa√≠s:</label>
      <select formControlName="pais" id="pais">
        <option value>-- Selecciona un pa√≠s --</option>
        <option *ngFor="let pais of paises" [value]="pais">{{
          pais
          }}</option>
      </select>
    </div>

    <!-- Ciudades del pa√≠s seleccionado -->
    <div *ngIf="ciudades.length > 0" class="tree-container">
      <div class="tree-node expand">
        <span class="tree-label">üìÅ {{ form.value.pais }}</span>
        <ul class="tree-children">
          <li *ngFor="let ciudad of ciudades">
            <label>
              <input type="radio" formControlName="ciudad"
                [value]="ciudad" name="ciudad" />
              {{ ciudad }}
            </label>
          </li>
        </ul>
      </div>
    </div>

    <!-- Rango de precio -->
    <div class="form-group">
      <label for="priceRangeAlojamientos">üí∞ Rango de Precio:</label>
      <input type="range" formControlName="priceRangeAlojamientos" id="priceRange"
        min="15" max="200" step="5" />
      <span>0‚Ç¨ - {{ form.value.priceRangeAlojamientos }}‚Ç¨</span>
    </div>
  </form>

  <div class="content-container">
    <div class="card-container">
      <div class="card-deck">
        <div class="card expand"
          *ngFor="let alojamiento of alojamientosFiltrados  | paginate: { itemsPerPage: 6, currentPage: p }">
          <img [src]="alojamiento.imagenes[0]" class="card-img-top"
            alt="Alojamiento">
          <div class="card-body">
            <h5 class="card-title">{{ alojamiento.nombre_alojamiento }}</h5>
            <p class="card-text">{{ alojamiento.descripcion }}</p>
            <p class="card-text">{{ alojamiento.pais }}, {{ alojamiento.ciudad
              }}</p>
            <p>{{alojamiento.precio_dia}} ‚Ç¨/dia</p>
            <button class="btn btn-primary"
              (click)="abrirModal(alojamiento)">Saber
              m√°s</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Paginaci√≥n -->
    <div class="paginacion">
      <pagination-controls (pageChange)="p = $event"
        previousLabel="Anterior"
        nextLabel="Siguiente">
      </pagination-controls>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal-overlay" *ngIf="modalAbierto && alojamientoSeleccionado">
  <div class="modal-container">
    <button class="close-btn" (click)="cerrarModal()">‚úñ</button>

    <div class="modal-content">
      <!-- Carrousel de im√°genes -->
      <div class="carousel">
        <img *ngIf="alojamientoSeleccionado?.imagenes?.length > 0"
          [src]="alojamientoSeleccionado.imagenes[imagenActual].url"
          alt="Imagen del alojamiento">
        <button *ngIf="alojamientoSeleccionado?.imagenes?.length > 1"
          class="prev" (click)="cambiarImagen(-1)">&#10094;</button>
        <button *ngIf="alojamientoSeleccionado?.imagenes?.length > 1"
          class="next" (click)="cambiarImagen(1)">&#10095;</button>
      </div>

      <!-- Informaci√≥n del alojamiento -->
      <div class="modal-info">
        <h2 class="titulo-modal">{{ alojamientoSeleccionado.nombre_alojamiento
          }}</h2>
        <p class="ciudad-pais">{{alojamientoSeleccionado.pais}},
          {{alojamientoSeleccionado.ciudad}}</p>
        <div>
          <p class="descripcion-title"><strong>Descripci√≥n</strong></p>
          <p class="descripcion-modal">{{ alojamientoSeleccionado.descripcion
            }}</p>
        </div>
        <div class="precio-persona-container">
          <div class="precio-persona">
            <p class="precio-modal">{{ alojamientoSeleccionado.precio_dia
              }}‚Ç¨/dia</p>
            <p class="max-personas">
              <img class="icono-personas"
                src="http://172.17.131.14:3000/uploads/1744294057980.png"
                alt="icono-personas">
              {{alojamientoSeleccionado.max_personas}}</p>
          </div>
          <button class="add-cart-btn"
            (click)="agregarAlCarrito(alojamientoSeleccionado)">
            ¬°Rervar Ahora!
          </button>
        </div>

      </div>
    </div>
  </div>
</div>